<div id="submenu">
  <ul>
    <%- case when @expression -%>
      <li><%= link_to t('page.back'), expression_manifestations_path(@expression) -%></li>
    <%- when @patron -%>
      <li><%= link_to t('page.back'), patron_manifestations_path(@patron) -%></li>
    <%- else -%>
      <li><%= link_to t('page.back'), manifestations_path -%></li>
    <%- end -%>
  </ul>
</div>

<div id="content_detail">
  <h1><%= t('page.new', :model => t('activerecord.models.manifestation')) -%></h1>
  <p>
    <b><%= t('activerecord.models.expression') -%></b><br />
    <%= link_to h(@expression.original_title), @expression -%>
    <%- if @expression.serial? and !@expression.subscribed? -%>
      <br />
      <span class="error_message">
        <%= t('subscribe.this_subscription_is_expired') -%>
        <%= link_to t('page.listing', :model => t('activerecord.models.subscription')), expression_subscriptions_path(@expression) -%>
      </span>
    <%- end -%>
  </p>

<%= error_messages_for :manifestation -%>

<%- form_for(:manifestation, :url => expression_manifestations_path(@expression)) do |f| -%>
  <p>
    <b><%= t('page.title') -%></b><br />
    <%= f.text_field :original_title, :value => @expression.original_title, :class => 'resource_title' -%>
  </p>
  <p>
    <b><%= t('activerecord.attributes.manifestation.title_transcription') -%></b><br />
    <%- if @expression -%>
      <%= f.text_field :title_transcription, :value => @expression.title_transcription, :class => 'resource_title' -%>
    <%- else -%>
      <%= f.text_field :title_transcription, :class => 'resource_title' -%>
    <%- end -%>
  </p>
  <p>
    <b><%= t('activerecord.attributes.manifestation.title_alternative') -%></b><br />
    <%- if @expression -%>
      <%= f.text_field :title_alternative, :value => @expression.title_alternative, :class => 'resource_title' -%>
    <%- else -%>
      <%= f.text_field :title_alternative, :class => 'resource_title' -%>
    <%- end -%>
  </p>
  
  <p>
    <b><%= t('activerecord.models.manifestation_form') -%></b>
    <%= f.select(:manifestation_form_id, @manifestation_forms.collect{|m| [m.display_name, m.id]}) -%>
  </p>

  <p>
    <b><%= t('activerecord.attributes.manifestation.date_of_publication') -%></b>
    <%= f.date_select :date_of_publication, :blank => true -%>
  </p>

  <p>
    <%- if @expression.serial? -%>
      <%= render :partial => 'new_serial', :locals => {:f => f} -%>
    <%- else -%>
      <b><%= t('activerecord.attributes.manifestation.edition') -%></b>
      <%= f.text_field :edition, :class => 'resource_integer' -%>
      <b><%= t('activerecord.attributes.manifestation.volume_number_list') -%></b>
      <%= f.text_field :volume_number_list, :class => 'resource_integer' -%>
    <%- end -%>
  </p>

  <%- unless @expression.serial? -%>
    <p>
      <b><%= t('activerecord.attributes.manifestation.isbn') -%></b>
      <%= f.text_field :isbn, :class => 'resource_isbn_issn' -%>
    </p>
  <%- end -%>

  <p>
    <b><%= t('activerecord.attributes.manifestation.start_page') -%></b>
    <%= f.text_field :start_page, :class => 'resource_integer' -%>
    <b><%= t('activerecord.attributes.manifestation.end_page') -%></b>
    <%= f.text_field :end_page, :class => 'resource_integer' -%>
  </p>

  <p>
  <b><%= t('activerecord.attributes.manifestation.height') -%>(cm)</b>
    <%= f.text_field :height, :class => 'resource_integer' -%>
  <b><%= t('activerecord.attributes.manifestation.width') -%>(cm)</b>
    <%= f.text_field :width, :class => 'resource_integer' -%>
  <b><%= t('activerecord.attributes.manifestation.depth') -%>(cm)</b>
    <%= f.text_field :depth, :class => 'resource_integer' -%>
  </p>

  <p>
    <b><%= t('activerecord.attributes.manifestation.price') -%></b>
    <%= f.text_field :price, :class => 'resource_integer' -%>
  </p>

  <p>
    <b><%= t('activerecord.attributes.manifestation.access_address') -%></b><br />
    <%= f.text_field :access_address, :class => 'resource_url' -%>
  </p>

  <p>
    <b><%= t('activerecord.attributes.manifestation.repository_content') -%></b>
    <%= f.check_box :repository_content -%>
  </p>
  
  <p>
    <b><%= t('role.required_role') -%></b>
    <%= f.select(:required_role_id, @roles.collect{|r| [r.name, r.id]}) -%>
  </p>

  <p>
    <b><%= t('activerecord.attributes.manifestation.note') -%></b><br />
    <%= f.text_area :note, :class => 'resource_textarea' -%>
  </p>

  <p>
    <%= hidden_field_tag :expression_id, @expression.id if @expression -%>
    <%= hidden_field_tag :item_id, @item.id if @item -%>
    <%= hidden_field_tag :patron_id, @patron.id if @patron -%>
    <%= submit_tag t('page.create') -%>
  </p>
<%- end -%>
</div>
