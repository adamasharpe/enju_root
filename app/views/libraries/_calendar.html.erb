  <%= calendar(:year => @date.year, :month => @date.month) do |date|
    event_days = @library.events.collect{|e| e.started_at.beginning_of_day}
    cal_text = (link_to h(date.mday), "/calendar/" + date.strftime("%Y-%m-%d")) + "<br />"
    events = @library.events.find(:all, :conditions => ['started_at <= ? AND ended_at >= ?', date, date])
    events.each do |event|
      cal_text += (link_to h(event.title), event)  + "<br />"
    end
    [cal_text, {:class => 'specialDay'}]
  end -%>
  <%= link_to_remote t('page.previous'), :update => 'library_calendar', :url => library_path(@library.short_name, :date => (@date - 1.month).strftime('%Y-%m-%d')), :method => :get -%>
 <%= link_to_remote ('This month'), :update => 'library_calendar', :url => library_path(@library.short_name, :date => Time.now.strftime('%Y-%m-%d')), :method => :get -%>
 <%= link_to_remote t('page.next'), :update => 'library_calendar', :url => library_path(@library.short_name, :date => (@date + 1.month).strftime('%Y-%m-%d')), :method => :get -%>
