<div id="submenu">
  <ul>
    <li><%= link_to t('page.new', :model => t('activerecord.models.purchase_request')), new_user_purchase_request_path(current_user.login)%></li>
    <%- case params[:mode] when 'not_ordered' -%>
      <li><%= link_to t('purchase_request.ordered'), purchase_requests_path(:mode => 'ordered') -%></li>
      <li><%= link_to t('purchase_request.all_request'), purchase_requests_path -%></li>
    <%- when 'ordered' -%>
      <li><%= link_to t('purchase_request.not_ordered'), purchase_requests_path(:mode => 'not_ordered') -%></li>
      <li><%= link_to t('purchase_request.all_request'), purchase_requests_path -%></li>
    <%- else -%>
      <li><%= link_to t('purchase_request.ordered'), purchase_requests_path(:mode => 'ordered') -%></li>
      <li><%= link_to t('purchase_request.not_ordered'), purchase_requests_path(:mode => 'not_ordered') -%></li>
    <%- end -%>
  </ul>
<p>
  <%- if @user -%>
    <%= link_to (image_tag 'feed-icon-14x14.png', :size => '14x14', :alt => t('page.feed'), :border => 0), :user_id => @user.login, :format => :rss -%>
    (<%= link_to ('RSS'), user_purchase_requests_path(@user.login, :format => :rss) -%>)
    (<%= link_to ('CSV'), user_purchase_requests_path(@user.login, :format => :csv, :locale => @locale) -%>)
  <%- else -%>
    <%= link_to (image_tag 'feed-icon-14x14.png', :size => '14x14', :alt => t('page.feed'), :border => 0), :format => :rss -%>
    (<%= link_to ('RSS'), purchase_requests_path(:format => :rss) -%>)
    (<%= link_to ('CSV'), purchase_requests_path(:format => :csv, :locale => @locale) -%>)
  <%- end -%>
</p>

<h4><%= t('page.bookmarklet') -%></h4>
<ul>
  <li><a href="javascript:window.location.href='<%=h new_user_purchase_request_url(current_user.login) -%>?url='+encodeURIComponent(location.href)+'&title='+encodeURIComponent(document.title);"><%= t('purchase_request.add_to_purchase_request') -%></a></li>
</ul>
</div>

<div id="content_detail">
  <h1 class="title"><%= t('page.listing', :model => t('activerecord.models.purchase_request')) -%></h1>

<div id="content_list">

<table id="index">
  <tr>
    <th><%= t('activerecord.attributes.purchase_request.title') -%></th>
    <th><%= t('activerecord.attributes.purchase_request.price') -%></th>
    <th><%= t('activerecord.models.order_list') -%></th>
  </tr>

  <%- @purchase_requests.each_with_index do |purchase_request, i| -%>
    <tr class="line<%= cycle("0", "1") -%>">
      <td>
        <%= link_to h(purchase_request.title), purchase_request -%>
        <br />
        <%=h purchase_request.author -%>
        <%=h purchase_request.publisher -%>
        <%=h purchase_request.date_of_publication -%>
      </td>
      <td><%=h purchase_request.price -%></td>
      <td>
        <%= link_to h(purchase_request.order_list.title), order_list_purchase_requests_path(purchase_request.order_list) if purchase_request.order_list -%>
      </td>
      <td><%= link_to t('page.edit'), edit_user_purchase_request_path(purchase_request.user.login, purchase_request) -%></td>
      <%- if current_user.has_role?('Librarian') -%>
        <td><%= link_to t('page.destroy'), purchase_request, :confirm => t('page.are_you_sure'), :method => :delete -%></td>
      <%- end -%>
    </tr>
  <%- end -%>
</table>

<%= will_paginate(@purchase_requests, :previous_label => "&#171; " + t('page.previous'), :next_label => "&#187; " + t('page.next')) -%>

</div>
</div>
