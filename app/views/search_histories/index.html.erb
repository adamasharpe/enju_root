<%- if params[:mode] == 'not_found' -%>
  <h1><%= t('search_history.failed_search') -%></h1>
  <%= reverse_tag_cloud(SearchHistory.not_found_query(2, 6.month.ago)) -%>
  <p>
    <%= link_to t('search_history.all_history'), search_histories_path -%>
  </p>
<%- else -%>
  <h1><%= t('page.listing', :model => t('activerecord.models.search_history')) -%></h1>
  <p>
    <%= link_to t('search_hisotry.failed_search'), search_histories_path(:mode => 'not_found') -%>
  </p>
<%- end -%>

<table id="index">
  <tr>
    <th><%= t('activerecord.attributes.search_history.query') -%></th>
    <th><%= t('activerecord.attributes.search_history.number_of_records') -%></th>
    <%- unless params[:mode] == 'not_found' -%>
      <th><%= t('activerecord.attributes.search_history.start_record') -%></th>
    <%- end -%>
    <th><%= t('search_history.searched_at') -%></th>
  </tr>
  
<%- @search_histories.each_with_index do |search_history, i| -%>
  <tr class="line<%= cycle("0", "1") -%>">
    <td><%= link_to h(search_history.query), manifestations_path(:query => search_history.query) -%></td>
    <td><%=h search_history.number_of_records -%></td>
    <%- unless params[:mode] == 'not_found' -%>
      <td><%=h search_history.start_record -%></td>
    <%- end -%>
    <td><%=h search_history.created_at -%></td>
    <%- if_authorized?(:destroy, search_history) do -%>
      <td><%= link_to t('page.show'), search_history -%></td>
      <td><%= link_to t('page.edit'), edit_search_history_path(search_history) -%></td>
      <td><%= link_to t('page.destroy'), search_history, :confirm => t('page.are_you_sure'), :method => :delete -%></td>
    <%- end -%>
  </tr>
<%- end -%>
</table>

<%= will_paginate(@search_histories, :previous_label => "&#171; " + t('page.previous'), :next_label => "&#187; " + t('page.next')) -%>
